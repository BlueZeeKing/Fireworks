var width=window.innerWidth,height=window.innerHeight,audio=new Audio("fireworkSound.mp3");function radians(t){return t*(Math.PI/180)}function degrees(t){return t*(180/Math.PI)}function random(t,s){return Math.floor(Math.random()*(s-t)+t+1)}function randomColor(t){return t[Math.floor(Math.random()*t.length)]}function round(t,s){var i=Math.pow(10,s);return Math.round(t*i)/i}function clear(t,s,i){s.beginPath(),s.fillStyle=t,s.globalAlpha=i,s.fillRect(0,0,width,height),s.globalAlpha=1}function airResistance(t,s,i){let a=Math.sqrt(Math.pow(s,2)+Math.pow(i,2)),h=1*a;a>0?h-=Math.pow(a,2)*t:h+=Math.pow(a,2)*t,a=round(a,3),h=round(h,3);let l=h/a;return[s*l,i*l]}function fireworkSound(){audio.cloneNode(!0).play()}function shake(t){t.classList.add("shake")}function stopShake(t){t.classList.remove("shake")}class Fireworks{constructor(t,s="black",i=["orange"],a="yellow"){this.clearRate=.2,this.gravity=.06,this.oldAge=35,this.colors="string"==typeof i?[i]:i,this.canvasDOM=t,this.canvas=t.getContext("2d"),this.bgColor=s,this.launchColor=a,this.drag=.03,clear(s,this.canvas,1),this.Vs=[];for(let t=0;t<360;t+=10){let s=10*Math.cos(radians(t)),i=10*Math.sin(radians(t));this.Vs.push([s,i])}this.launchParticles=[],this.particles=[]}start(t,s){fireworkSound(),shake(this.canvasDOM);let i=[],a=randomColor(this.colors);console.log(this.colors);for(let h=0;h<this.Vs.length;h++)i.push([t,s,this.Vs[h][0],this.Vs[h][1],a,1,0]);this.particles=this.particles.concat(i)}launch(t,s,i,a){console.log(t,s,i,a);let h=a-s,l=i-t,c=Math.asin(l/Math.sqrt(l**2+h**2)),e=[t,s,5*Math.sin(c),5*Math.cos(c),i,a];this.launchParticles=this.launchParticles.concat([e])}update(){clear(this.bgColor,this.canvas,this.clearRate),0==this.particles.length&&stopShake(this.canvasDOM);for(let t=0;t<this.particles.length;t++)try{if(this.canvas.beginPath(),this.canvas.globalAlpha=this.particles[t][5],this.canvas.fillStyle=this.particles[t][4],this.canvas.arc(this.particles[t][0],this.particles[t][1],2,0,2*Math.PI),this.canvas.fill(),this.canvas.globalAlpha=1,this.particles[t][0]+=this.particles[t][2],this.particles[t][1]+=this.particles[t][3],this.particles[t][3]+=this.gravity,this.particles[t][6]>5){let s=airResistance(this.drag,this.particles[t][2],this.particles[t][3],t);this.particles[t][2]=s[0],this.particles[t][3]=s[1]}this.particles[t][6]++,this.particles[t][0]<0||this.particles[t][0]>width||this.particles[t][1]<0||this.particles[t][1]>height||0==this.particles[t][5]?this.particles.splice(t,1):this.particles[t][6]>this.oldAge&&this.particles[t][5]>0&&(this.particles[t][5]=parseFloat((this.particles[t][5]-.05).toFixed(3)))}catch{}for(let t=0;t<this.launchParticles.length;t++)try{this.canvas.beginPath(),this.canvas.globalAlpha=1,this.canvas.fillStyle=this.launchColor,this.canvas.arc(this.launchParticles[t][0],this.launchParticles[t][1],2,0,2*Math.PI),this.canvas.fill(),this.launchParticles[t][0]+=this.launchParticles[t][2],this.launchParticles[t][1]-=this.launchParticles[t][3],this.launchParticles[t][0]>this.launchParticles[t][4]-5&&this.launchParticles[t][0]<this.launchParticles[t][4]+5&&this.launchParticles[t][1]>this.launchParticles[t][5]-5&&this.launchParticles[t][1]<this.launchParticles[t][5]+5?(this.start(this.launchParticles[t][0],this.launchParticles[t][1]),this.launchParticles.splice(t,1)):(this.launchParticles[t][0]<0||this.launchParticles[t][0]>width||this.launchParticles[t][1]<0||this.launchParticles[t][1]>height)&&this.launchParticles.splice(t,1)}catch(t){console.log(t)}0==this.particles.length&&0==this.launchParticles.length&&clear(this.bgColor,this.canvas,1)}}