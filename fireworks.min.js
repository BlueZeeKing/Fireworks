class Fireworks{constructor(t,s="black",i=["orange"],a="yellow"){this.clearRate=.2,this.gravity=.06,this.oldAge=35,this.colors="string"==typeof i?[i]:i,this.canvasDOM=t,this.canvas=t.getContext("2d"),this.bgColor=s,this.launchColor=a,this.drag=.03,this.clear(1),this.Vs=[];for(let t=0;t<360;t+=10){let s=10*Math.cos(this.radians(t)),i=10*Math.sin(this.radians(t));this.Vs.push([s,i])}this.launchParticles=[],this.particles=[],this.audio=new Audio("fireworkSound.mp3")}randomColor(t){return t[Math.floor(Math.random()*t.length)]}radians(t){return t*(Math.PI/180)}round(t,s){var i=Math.pow(10,s);return Math.round(t*i)/i}clear(t){this.canvas.beginPath(),this.canvas.fillStyle=this.bgColor,this.canvas.globalAlpha=t,this.canvas.fillRect(0,0,width,height),this.canvas.globalAlpha=1}fireworkSound(){this.audio.cloneNode(!0).play()}shake(){this.canvasDOM.classList.add("shake")}stopShake(){this.canvasDOM.classList.remove("shake")}airResistance(t,s){let i=Math.sqrt(Math.pow(t,2)+Math.pow(s,2)),a=1*i;i>0?a-=Math.pow(i,2)*this.drag:a+=Math.pow(i,2)*this.drag,i=this.round(i,3),a=this.round(a,3);let h=a/i;return[t*h,s*h]}start(t,s){this.fireworkSound(),this.shake();let i=[],a=this.randomColor(this.colors);console.log(this.colors);for(let h=0;h<this.Vs.length;h++)i.push([t,s,this.Vs[h][0],this.Vs[h][1],a,1,0]);this.particles=this.particles.concat(i)}launch(t,s,i,a){let h=a-s,l=i-t,c=Math.asin(l/Math.sqrt(l**2+h**2)),e=[t,s,5*Math.sin(c),5*Math.cos(c),i,a];this.launchParticles=this.launchParticles.concat([e])}update(){this.clear(this.clearRate),0==this.particles.length&&this.stopShake();for(let t=0;t<this.particles.length;t++){if(this.canvas.beginPath(),this.canvas.globalAlpha=this.particles[t][5],this.canvas.fillStyle=this.particles[t][4],this.canvas.arc(this.particles[t][0],this.particles[t][1],2,0,2*Math.PI),this.canvas.fill(),this.canvas.globalAlpha=1,this.particles[t][0]+=this.particles[t][2],this.particles[t][1]+=this.particles[t][3],this.particles[t][3]+=this.gravity,this.particles[t][6]>5){let s=this.airResistance(this.particles[t][2],this.particles[t][3],t);this.particles[t][2]=s[0],this.particles[t][3]=s[1]}this.particles[t][6]++,this.particles[t][0]<0||this.particles[t][0]>window.innerWidth||this.particles[t][1]<0||this.particles[t][1]>window.innerHeight||0==this.particles[t][5]?this.particles.splice(t,1):this.particles[t][6]>this.oldAge&&this.particles[t][5]>0&&(this.particles[t][5]=parseFloat((this.particles[t][5]-.05).toFixed(3)))}for(let t=0;t<this.launchParticles.length;t++)this.canvas.beginPath(),this.canvas.globalAlpha=1,this.canvas.fillStyle=this.launchColor,this.canvas.arc(this.launchParticles[t][0],this.launchParticles[t][1],2,0,2*Math.PI),this.canvas.fill(),this.launchParticles[t][0]+=this.launchParticles[t][2],this.launchParticles[t][1]-=this.launchParticles[t][3],this.launchParticles[t][0]>this.launchParticles[t][4]-5&&this.launchParticles[t][0]<this.launchParticles[t][4]+5&&this.launchParticles[t][1]>this.launchParticles[t][5]-5&&this.launchParticles[t][1]<this.launchParticles[t][5]+5?(this.start(this.launchParticles[t][0],this.launchParticles[t][1]),this.launchParticles.splice(t,1)):(this.launchParticles[t][0]<0||this.launchParticles[t][0]>window.innerWidth||this.launchParticles[t][1]<0||this.launchParticles[t][1]>window.innerHeight)&&this.launchParticles.splice(t,1);0==this.particles.length&&0==this.launchParticles.length&&this.clear(1)}}